<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Laurie Stevison &amp; Amanda Clark" />
  <title>Advanced Graphing in R</title>
  <style type="text/css">
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
            pre > code.sourceCode { white-space: pre; position: relative; }
            pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
            pre > code.sourceCode > span:empty { height: 1.2em; }
            .sourceCode { overflow: visible; }
            code.sourceCode > span { color: inherit; text-decoration: inherit; }
            div.sourceCode { margin: 1em 0; }
            pre.sourceCode { margin: 0; }
            @media screen {
            div.sourceCode { overflow: auto; }
            }
            @media print {
            pre > code.sourceCode { white-space: pre-wrap; }
            pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
            }
            pre.numberSource code
              { counter-reset: source-line 0; }
            pre.numberSource code > span
              { position: relative; left: -4em; counter-increment: source-line; }
            pre.numberSource code > span > a:first-child::before
              { content: counter(source-line);
                position: relative; left: -1em; text-align: right; vertical-align: baseline;
                border: none; display: inline-block;
                -webkit-touch-callout: none; -webkit-user-select: none;
                -khtml-user-select: none; -moz-user-select: none;
                -ms-user-select: none; user-select: none;
                padding: 0 4px; width: 4em;
                color: #aaaaaa;
              }
            pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
            div.sourceCode
              {   }
            @media screen {
            pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
            }
            code span.al { color: #ff0000; font-weight: bold; } /* Alert */
            code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
            code span.at { color: #7d9029; } /* Attribute */
            code span.bn { color: #40a070; } /* BaseN */
            code span.bu { color: #008000; } /* BuiltIn */
            code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
            code span.ch { color: #4070a0; } /* Char */
            code span.cn { color: #880000; } /* Constant */
            code span.co { color: #60a0b0; font-style: italic; } /* Comment */
            code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
            code span.do { color: #ba2121; font-style: italic; } /* Documentation */
            code span.dt { color: #902000; } /* DataType */
            code span.dv { color: #40a070; } /* DecVal */
            code span.er { color: #ff0000; font-weight: bold; } /* Error */
            code span.ex { } /* Extension */
            code span.fl { color: #40a070; } /* Float */
            code span.fu { color: #06287e; } /* Function */
            code span.im { color: #008000; font-weight: bold; } /* Import */
            code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
            code span.kw { color: #007020; font-weight: bold; } /* Keyword */
            code span.op { color: #666666; } /* Operator */
            code span.ot { color: #007020; } /* Other */
            code span.pp { color: #bc7a00; } /* Preprocessor */
            code span.sc { color: #4070a0; } /* SpecialChar */
            code span.ss { color: #bb6688; } /* SpecialString */
            code span.st { color: #4070a0; } /* String */
            code span.va { color: #19177c; } /* Variable */
            code span.vs { color: #4070a0; } /* VerbatimString */
            code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
          </style>
  <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <script src="site_libs/header-attrs-2.17/header-attrs.js"></script>
  <link href="site_libs/slidy-2/styles/slidy.css" rel="stylesheet" />
  <script src="site_libs/slidy-2/scripts/slidy.js"></script>
  <script src="site_libs/slidy_shiny-1/slidy_shiny.js"></script>
</head>
<body>
<div class="slide titlepage">
  <h1 class="title">Advanced Graphing in R</h1>
  <p class="author">
Laurie Stevison &amp; Amanda Clark
  </p>
</div>
<div id="getting-started" class="slide section level2">
<h1>Getting Started</h1>
<p><em>If you are using this code with the video, note that some slides
have been added post-recording and are not shown.</em></p>
<p>We will be working with the “BodyFat.csv” dataset again. Make an R
Notebook for this walk-through tutorial to save all the code you will be
learning. We will cover:</p>
<ul>
<li>Adding text to plots</li>
<li>Plotting on multiple Axes</li>
<li>Adding figure legends</li>
<li>Making multi-panel plots</li>
<li>Adjusting figure margins</li>
<li>Writing images to a file</li>
<li>Paralleling base R code to <code>ggplot2</code> syntax to accomplish
the same goals</li>
</ul>
</div>
<div class="slide section level2">

<ul>
<li><p>You are working within an R project (check in the top right
corner of RStudio - you should see the project name
“R_Mini_Course”).</p></li>
<li><p>This means that the project directory will also be set as working
directory. The exception is in a R Notebook, where the working directory
is where the R Notebook is saved.</p></li>
<li><p>You should be saving your notebooks in the R Project and using
<code>../..</code> to point at the main project directory.</p></li>
<li><p>Before starting, it may be helpful to have a chunk of code that
does the following:</p>
<ul>
<li>clear your workspace <code>rm(list=ls())</code></li>
<li>load your packages <code>library(&lt;package-name&gt;)</code></li>
<li>check your session information <code>sessionInfo()</code></li>
<li>list files in your working directory
<code>list.files(getwd())</code></li>
</ul></li>
</ul>
</div>
<div id="read-in-dataset" class="slide section level2">
<h1>Read in dataset</h1>
<p>You will need to add path information to the <code>raw_data</code>
directory once you have uncompressed the data tarball.</p>
<p>Now, let’s return to the “BodyFat.csv” dataset by reading in the CSV
file:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fat=read.csv(file=&quot;BodyFat.csv&quot;)</span></span></code></pre></div>
<p>You may also read in the previously made object into
<code>fat</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fat <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;data/BodyFat.rds&quot;</span>) </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fat)</span></code></pre></div>
<pre><code>##   IDNO BODYFAT DENSITY AGE WEIGHT HEIGHT ADIPOSITY NECK CHEST ABDOMEN   HIP THIGH KNEE ANKLE
## 1    1    12.6  1.0708  23 154.25  67.75      23.7 36.2  93.1    85.2  94.5  59.0 37.3  21.9
## 2    2     6.9  1.0853  22 173.25  72.25      23.4 38.5  93.6    83.0  98.7  58.7 37.3  23.4
## 3    3    24.6  1.0414  22 154.00  66.25      24.7 34.0  95.8    87.9  99.2  59.6 38.9  24.0
## 4    4    10.9  1.0751  26 184.75  72.25      24.9 37.4 101.8    86.4 101.2  60.1 37.3  22.8
## 5    5    27.8  1.0340  24 184.25  71.25      25.6 34.4  97.3   100.0 101.9  63.2 42.2  24.0
## 6    6    20.6  1.0502  24 210.25  74.75      26.5 39.0 104.5    94.4 107.8  66.0 42.0  25.6
##   BICEPS FOREARM WRIST  X
## 1   32.0    27.4  17.1 NA
## 2   30.5    28.9  18.2 NA
## 3   28.8    25.2  16.6 NA
## 4   32.4    29.4  18.2 NA
## 5   32.2    27.7  17.7 NA
## 6   35.7    30.6  18.8 NA</code></pre>
</div>
<div id="density-is-all-that-matters" class="slide section level2">
<h1>Density is all that matters!</h1>
<p>In a previous video, we found several parameters correlated
significantly with bodyfat, but in fact, density explains the majority
of the variance in bodyfat. Once that is accounted for, no other
parameters matter.</p>
<p>So, let’s focus on density:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot density and bodyfat</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fat<span class="sc">$</span>BODYFAT<span class="sc">~</span>fat<span class="sc">$</span>DENSITY)</span></code></pre></div>
<p><img src="5.03.Advanced_Graphing_in_R_files/figure-slidy/density-1.png" width="768" /></p>
<p>These variables show an inverse relationship - as density increases,
bodyfat goes down. What does this mean?</p>
</div>
<div id="add-statistical-results-to-our-plot"
class="slide section level2">
<h1>Add statistical results to our plot:</h1>
<p>As we discussed in a previous video, it helps give your audience
context if you provide statistical results within a graphic.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#redo the statistical correlation</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(fat<span class="sc">$</span>BODYFAT,fat<span class="sc">$</span>DENSITY)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  fat$BODYFAT and fat$DENSITY
## t = -101.52, df = 250, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.9906950 -0.9847529
## sample estimates:
##        cor 
## -0.9880867</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#remember we can isolate just the p-value</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="fu">cor.test</span>(fat<span class="sc">$</span>BODYFAT,fat<span class="sc">$</span>DENSITY)<span class="sc">$</span>p.value</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#to print it, we can just &#39;call&#39; p:</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 3.280973e-205</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#let&#39;s round this to look a bit nicer when we add it to our plot</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(p,<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#hmm, not quite right, we can use the function `signif` to round scientific notation figures</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">signif</span>(p,<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 3.3e-205</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#to add it to our plot, we will use the function `paste` which will append &quot;p = &quot; to the actual value of p.</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">&quot;p = &quot;</span>,<span class="fu">signif</span>(p,<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] &quot;p =  3.3e-205&quot;</code></pre>
</div>
<div id="add-p-value-to-a-plot" class="slide section level2">
<h1>Add p-value to a plot</h1>
<p>First, let’s improve our plot by adding a descriptive title and label
the X and Y axes:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#re-plot data with labels</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fat<span class="sc">$</span>BODYFAT<span class="sc">~</span>fat<span class="sc">$</span>DENSITY,<span class="at">main=</span><span class="st">&quot;Body Fat versus Density&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Density&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Body Fat&quot;</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#now, we can use the `text` function to add this to the plot</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#note: to put it in the upper left quadrant, I added x and y coordinates. Feel free to move it around and change the color.</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.08</span>,<span class="dv">40</span>,<span class="fu">paste</span>(<span class="st">&quot;p = &quot;</span>,<span class="fu">signif</span>(p,<span class="dv">2</span>)),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="5.03.Advanced_Graphing_in_R_files/figure-slidy/improve%20plot-1.png" width="768" /></p>
</div>
<div
id="lets-examine-each-variable-for-all-the-individuals-in-the-dataset"
class="slide section level2">
<h1>Let’s examine each variable for all the individuals in the
dataset</h1>
<p>We can put bodyfat on the left y-axis and density on the right
y-axis.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot body fat per individual</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fat<span class="sc">$</span>IDNO,fat<span class="sc">$</span>BODYFAT,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">main=</span><span class="st">&quot;Body Fat&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;252 Men Sampled&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Body Fat&quot;</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#add margin text to label the 2nd y-axis</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Density&quot;</span>,<span class="at">side=</span><span class="dv">4</span>) </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#call a new plot</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">#now, intialize an empty plot of density per individual (x-axis needs to be the same to make this work!)</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#note we have used type=&quot;n&quot; to make an empty plot, disabled the axes and made labels empty</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fat<span class="sc">$</span>IDNO,fat<span class="sc">$</span>DENSITY,<span class="at">type=</span><span class="st">&quot;n&quot;</span>,<span class="at">axes=</span>F,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">#now, we plot the second y-axis, axis 4</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">4</span>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co">#add lines to this axis</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fat<span class="sc">$</span>IDNO,fat<span class="sc">$</span>DENSITY,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="5.03.Advanced_Graphing_in_R_files/figure-slidy/ind%20plot-1.png" width="768" /></p>
<p>This still looks a bit messy - it is hard to see that these two
values correlate at all? What is wrong?</p>
</div>
<div id="inverting-a-plot" class="slide section level2">
<h1>Inverting a plot</h1>
<p>Because Density correlates negatively with Body Fat, we will plot the
inverse of this parameter</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#first, let&#39;s adjust the margin parameters so we can better see the second y-axis</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">4</span>))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#replot bodyfat</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fat<span class="sc">$</span>IDNO,fat<span class="sc">$</span>BODYFAT,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">main=</span><span class="st">&quot;Body Fat&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;252 Men Sampled&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Body Fat&quot;</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">#move margin text outward so it does not run into tick marks</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Density&quot;</span>,<span class="at">side=</span><span class="dv">4</span>, <span class="at">line=</span><span class="dv">3</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">#okay, take 2 of the density plot</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fat<span class="sc">$</span>IDNO,<span class="sc">-</span>fat<span class="sc">$</span>DENSITY,<span class="at">type=</span><span class="st">&quot;n&quot;</span>,<span class="at">axes=</span>F,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">4</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fat<span class="sc">$</span>IDNO,<span class="sc">-</span>fat<span class="sc">$</span>DENSITY,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co">#yep, inverting is really that easy!</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co">#finally, let&#39;s add a legend</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;BodyFat&quot;</span>,<span class="st">&quot;Density&quot;</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>), <span class="at">lwd=</span><span class="dv">1</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="5.03.Advanced_Graphing_in_R_files/figure-slidy/ind%20plot2-1.png" width="768" /></p>
<p>Now, that looks a lot better!</p>
</div>
<div id="writing-to-files-and-making-multi-panel-plots"
class="slide section level2">
<h1>Writing to files and making multi-panel plots!</h1>
<p>Finally, let’s put all of this analysis together into a nice single
graphic:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#intialize a PDF file</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="at">file=</span><span class="st">&quot;Body_Fat.pdf&quot;</span>,<span class="at">height=</span><span class="dv">5</span>,<span class="at">width=</span><span class="dv">11</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#set it up to have two plots, one row, two columns</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#panel one</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">4</span>))</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fat<span class="sc">$</span>BODYFAT<span class="sc">~</span>fat<span class="sc">$</span>DENSITY,<span class="at">main=</span><span class="st">&quot;Body Fat versus Density&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Density&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Body Fat&quot;</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.08</span>,<span class="dv">40</span>,<span class="fu">paste</span>(<span class="st">&quot;p = &quot;</span>,<span class="fu">signif</span>(p,<span class="dv">2</span>)),<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">cex=</span><span class="fl">1.25</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">#panel two</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">4</span>))</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fat<span class="sc">$</span>IDNO,fat<span class="sc">$</span>BODYFAT,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">main=</span><span class="st">&quot;Body Fat and Density by Individual&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;252 Men Sampled&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Body Fat&quot;</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Density&quot;</span>,<span class="at">side=</span><span class="dv">4</span>, <span class="at">line=</span><span class="dv">3</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fat<span class="sc">$</span>IDNO,<span class="sc">-</span>fat<span class="sc">$</span>DENSITY,<span class="at">type=</span><span class="st">&quot;n&quot;</span>,<span class="at">axes=</span>F,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">4</span>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fat<span class="sc">$</span>IDNO,<span class="sc">-</span>fat<span class="sc">$</span>DENSITY,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;BodyFat&quot;</span>,<span class="st">&quot;Density&quot;</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>), <span class="at">lwd=</span><span class="dv">1</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="co">#turn off the plotting device</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<pre><code>## quartz_off_screen 
##                 2</code></pre>
</div>
<div id="final-image" class="slide section level2">
<h1>Final Image</h1>
<p><img src="5.03.Advanced_Graphing_in_R_files/figure-slidy/unnamed-chunk-3-1.png" width="1440" /></p>
<p>Because we wrote this to a file, you will need to open the file it
created. The image will NOT appear in your plots panel on the bottom
right.</p>
</div>
<div id="the-tidy-way" class="slide section level2">
<h1>The “tidy” way</h1>
<p>Now, we are going to create the same figure using
<code>ggplot2</code> from <code>tidyverse</code>. You were introduced to
this package in Module 3. <code>ggplot2</code> is based on the grammar
of graphics philosophy that the same components can be used to generate
almost any quantitative graphic.</p>
<p>We provide the data and specific how we want the data points
visualized and <code>ggplot2</code> adds a coordinate system to produce
our plot.</p>
<p>General structure of a command:</p>
<pre><code>ggplot(&lt;data&gt;) +
geom_&lt;function&gt;(mapping = aes(x = &lt;x-axis variable&gt;, y = &lt;y-axis variable&gt;, color = &lt;color&gt;), 
                              linetype = &lt;linetype&gt;, size = &lt;size&gt;, shape = &lt;shape&gt;)</code></pre>
<p>or you can specify mapping and data in the first layer and build onto
it.</p>
<pre><code>ggplot(&lt;data&gt;, aes(&lt;mappings&gt;)) +
geom_&lt;function&gt;()</code></pre>
</div>
<div id="bodyfat-density" class="slide section level2">
<h1>Bodyfat ~ Density</h1>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>gg_fat_density <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> fat) <span class="sc">+</span> <span class="co">#data</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> DENSITY, <span class="at">y =</span> BODYFAT)) <span class="co">#visualized as points</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>gg_fat_density</span></code></pre></div>
<p><img src="5.03.Advanced_Graphing_in_R_files/figure-slidy/unnamed-chunk-4-1.png" width="768" /></p>
<p>This looks somewhat like our first base R plot too! Now to add the
remaining modifications…</p>
</div>
<div class="slide section level2">

<p>We will take the <code>ggplot</code> object “gg_fat_density” we made
in the previous slide and build on it here:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>gg_fat_density <span class="ot">&lt;-</span> gg_fat_density <span class="sc">+</span> <span class="co">#ggplot object we created before</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">x =</span> <span class="fl">1.08</span>, <span class="at">y =</span> <span class="dv">40</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;p = &quot;</span>,<span class="fu">signif</span>(p,<span class="dv">2</span>))) <span class="sc">+</span> <span class="co"># with a red p-value in the top right corner</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Body Fat versus Density&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Density&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Body Fat&quot;</span>) <span class="sc">+</span> <span class="co"># and titles</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="co"># without the grid lines</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>gg_fat_density </span></code></pre></div>
<p><img src="5.03.Advanced_Graphing_in_R_files/figure-slidy/unnamed-chunk-5-1.png" width="768" /></p>
</div>
<div class="slide section level2">

<p>We could recreate the plot visualizing body fat and density on the
same plot but <code>ggplot2</code> creators frown upon the use of dual
axes for different data, so it is not straightforward to accomplish.
Take a moment to <a href="https://blog.datawrapper.de/dualaxis/">read
about why you would not generally want to create plots with dual axis
that are not transformations</a>.</p>
</div>
<div id="the-power-of-tidyverse" class="slide section level2">
<h1>The power of tidyverse</h1>
<p>The true power of the <code>tidyverse</code> meta-package is in the
connectivity between packages. Here we will use pipes with
<code>dplyr</code> and <code>ggplot2</code>. Let’s visualize the fitted
regression model from a subset of the body fat data.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># What did we learn about measured predictor variables from fat influencing body fat?</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(BODYFAT<span class="sc">~</span>WEIGHT<span class="sc">+</span>DENSITY<span class="sc">+</span>ADIPOSITY<span class="sc">+</span>AGE<span class="sc">+</span>HEIGHT<span class="sc">+</span>NECK<span class="sc">+</span>CHEST<span class="sc">+</span>ABDOMEN<span class="sc">+</span>HIP<span class="sc">+</span>THIGH<span class="sc">+</span>KNEE<span class="sc">+</span>ANKLE<span class="sc">+</span>BICEPS<span class="sc">+</span>FOREARM<span class="sc">+</span>WRIST,<span class="at">data=</span>fat)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = BODYFAT ~ WEIGHT + DENSITY + ADIPOSITY + AGE + HEIGHT + 
##     NECK + CHEST + ABDOMEN + HIP + THIGH + KNEE + ANKLE + BICEPS + 
##     FOREARM + WRIST, data = fat)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.7632 -0.3308 -0.0954  0.2078 13.9487 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  4.190e+02  9.802e+00  42.750   &lt;2e-16 ***
## WEIGHT       1.197e-02  1.467e-02   0.816    0.415    
## DENSITY     -3.816e+02  7.559e+00 -50.481   &lt;2e-16 ***
## ADIPOSITY   -5.493e-02  8.113e-02  -0.677    0.499    
## AGE          1.078e-02  8.808e-03   1.224    0.222    
## HEIGHT      -1.782e-02  3.019e-02  -0.590    0.556    
## NECK        -2.062e-02  6.427e-02  -0.321    0.749    
## CHEST        2.993e-02  2.856e-02   1.048    0.296    
## ABDOMEN      2.260e-02  3.016e-02   0.749    0.454    
## HIP          1.611e-02  4.023e-02   0.401    0.689    
## THIGH        1.354e-03  3.980e-02   0.034    0.973    
## KNEE        -3.978e-02  6.705e-02  -0.593    0.554    
## ANKLE       -7.170e-02  6.073e-02  -1.181    0.239    
## BICEPS      -6.291e-02  4.688e-02  -1.342    0.181    
## FOREARM      4.324e-02  5.447e-02   0.794    0.428    
## WRIST        3.640e-02  1.480e-01   0.246    0.806    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.166 on 236 degrees of freedom
## Multiple R-squared:  0.9787, Adjusted R-squared:  0.9774 
## F-statistic: 723.9 on 15 and 236 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="slide section level2">

<p>We learned that body fat and density (likely bone mineral density)
have an inverse relationship. <em>Can you find any information
supporting this with a Google search?</em> Here we will generate a
variable for age class, reduced the data set to age class and density
variables before plotting the fitted regression.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>gg_fit_fat <span class="ot">&lt;-</span> fat <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AGECLS =</span> <span class="fu">ifelse</span>(AGE <span class="sc">&lt;</span> <span class="dv">41</span>, <span class="st">&quot;early&quot;</span>, <span class="st">&quot;late&quot;</span>)) <span class="sc">%&gt;%</span> <span class="co"># generate AGECLS variable based on AGE variable</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">&quot;DENSITY&quot;</span>, <span class="st">&quot;AGECLS&quot;</span>, <span class="st">&quot;BODYFAT&quot;</span>) <span class="sc">%&gt;%</span>  <span class="co"># paring down to variables of interest</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> DENSITY, <span class="at">y =</span> BODYFAT)) <span class="sc">+</span> <span class="co"># mapping body fat ~ density</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> AGECLS, <span class="at">color =</span> AGECLS)) <span class="sc">+</span> <span class="co"># visualize points colored and shaped by AGECLS</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="fu">aes</span>(<span class="at">color =</span> AGECLS)) <span class="sc">+</span> <span class="co"># visualize fitted regression, colored by AGECLS</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> AGECLS) <span class="sc">+</span> <span class="co"># facet data by AGECLS</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">10</span>, <span class="st">&quot;pt&quot;</span>)) <span class="co">#Formatting and spacing the panels</span></span></code></pre></div>
</div>
<div class="slide section level2">

<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>gg_fit_fat</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="5.03.Advanced_Graphing_in_R_files/figure-slidy/unnamed-chunk-8-1.png" width="768" /></p>
<p>Whew, two <code>dplyr</code> functions followed by more
<code>ggplot2</code> functions!</p>
</div>
<div class="slide section level2">

<p><strong>Challenge Yourself</strong></p>
<ol style="list-style-type: decimal">
<li><p>Type <code>?ggsave</code> into your console and learn about
exporting figures from <code>ggplot2</code>. Try visualizing the
relationship of body fat to a different predictor and add an additional
pipe to the <code>ggsave</code> function to export your plot with the
same parameters we used for base R above!</p></li>
<li><p>What if we wanted a figure that included our first plot
“gg_fat_density” and “gg_fit_fat”? Read about <a
href="https://www.datanovia.com/en/lessons/combine-multiple-ggplots-into-a-figure/">ggplot2
compatible figure layouts here</a> and try it with these two
plots!</p></li>
</ol>
</div>
<div id="final-words-on-ggplot2" class="slide section level2">
<h1>Final words on <code>ggplot2</code></h1>
<p><code>tidyverse</code> was created by Hadley Wickham (Statistician
and Chief Scientists at RStudio) and associates. It is meant to make the
coding syntax and structure more intuitive and understandable.
<code>ggplot2</code> is one of many other packages within the
<code>tidyverse</code>, but they all share the same underlying design
and data structures (i.e., they work well together). Interested in
learning more?</p>
<p><a href="https://www.tidyverse.org/">Check out
<code>tidyverse</code></a>.</p>
<p><a href="https://r4ds.had.co.nz/">Check out the book <em>R for Data
Science</em></a>.</p>
<p><a
href="https://github.com/rstudio/cheatsheets/blob/main/data-visualization-2.1.pdf">Check
out the <code>ggplot2</code> cheatsheet</a>.</p>
</div>
<div class="slide section level2">

</div>

  <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
      document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>

</body>
</html>
