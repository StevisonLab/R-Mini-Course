<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Laurie Stevison &amp; Amanda Clark" />
  <title>Advanced Statstical Concepts in R</title>
  <style type="text/css">
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
            pre > code.sourceCode { white-space: pre; position: relative; }
            pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
            pre > code.sourceCode > span:empty { height: 1.2em; }
            .sourceCode { overflow: visible; }
            code.sourceCode > span { color: inherit; text-decoration: inherit; }
            div.sourceCode { margin: 1em 0; }
            pre.sourceCode { margin: 0; }
            @media screen {
            div.sourceCode { overflow: auto; }
            }
            @media print {
            pre > code.sourceCode { white-space: pre-wrap; }
            pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
            }
            pre.numberSource code
              { counter-reset: source-line 0; }
            pre.numberSource code > span
              { position: relative; left: -4em; counter-increment: source-line; }
            pre.numberSource code > span > a:first-child::before
              { content: counter(source-line);
                position: relative; left: -1em; text-align: right; vertical-align: baseline;
                border: none; display: inline-block;
                -webkit-touch-callout: none; -webkit-user-select: none;
                -khtml-user-select: none; -moz-user-select: none;
                -ms-user-select: none; user-select: none;
                padding: 0 4px; width: 4em;
                color: #aaaaaa;
              }
            pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
            div.sourceCode
              {   }
            @media screen {
            pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
            }
            code span.al { color: #ff0000; font-weight: bold; } /* Alert */
            code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
            code span.at { color: #7d9029; } /* Attribute */
            code span.bn { color: #40a070; } /* BaseN */
            code span.bu { color: #008000; } /* BuiltIn */
            code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
            code span.ch { color: #4070a0; } /* Char */
            code span.cn { color: #880000; } /* Constant */
            code span.co { color: #60a0b0; font-style: italic; } /* Comment */
            code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
            code span.do { color: #ba2121; font-style: italic; } /* Documentation */
            code span.dt { color: #902000; } /* DataType */
            code span.dv { color: #40a070; } /* DecVal */
            code span.er { color: #ff0000; font-weight: bold; } /* Error */
            code span.ex { } /* Extension */
            code span.fl { color: #40a070; } /* Float */
            code span.fu { color: #06287e; } /* Function */
            code span.im { color: #008000; font-weight: bold; } /* Import */
            code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
            code span.kw { color: #007020; font-weight: bold; } /* Keyword */
            code span.op { color: #666666; } /* Operator */
            code span.ot { color: #007020; } /* Other */
            code span.pp { color: #bc7a00; } /* Preprocessor */
            code span.sc { color: #4070a0; } /* SpecialChar */
            code span.ss { color: #bb6688; } /* SpecialString */
            code span.st { color: #4070a0; } /* String */
            code span.va { color: #19177c; } /* Variable */
            code span.vs { color: #4070a0; } /* VerbatimString */
            code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
          </style>
  <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
  <link href="site_libs/slidy-2/styles/slidy.css" rel="stylesheet" />
  <script src="site_libs/slidy-2/scripts/slidy.js"></script>
  <script src="site_libs/slidy_shiny-1/slidy_shiny.js"></script>
</head>
<body>
<div class="slide titlepage">
  <h1 class="title">Advanced Statstical Concepts in R</h1>
  <p class="author">
Laurie Stevison &amp; Amanda Clark
  </p>
</div>
<div id="getting-started" class="slide section level2">
<h1>Getting Started</h1>
<p><em>If you are using this code with the video, note that some slides
have been added post-recording and are not shown. See walkthrough2.R in
the compressed data tarball for the code from the recording.</em></p>
<p>For this tutorial we will be working with the “Lab6_Perl_v_Awk.csv”
“BodyFat.csv” datasets.</p>
<p>Make an R Notebook for this walk-through tutorial to save all the
code you will be learning. We will cover:</p>
<ul>
<li>Practice reading in datasets with more complexity</li>
<li>Making boxplots of factor data</li>
<li>Subsetting data in different ways</li>
<li>Fitting data to statistical models
<ul>
<li><code>aov</code></li>
<li><code>glm</code></li>
</ul></li>
</ul>
</div>
<div id="set-up-workspace" class="slide section level2">
<h1>Set up workspace</h1>
<ul>
<li><p>You are working within an R project (check in the top right
corner of RStudio - you should see the project name
“R_Mini_Course”).</p></li>
<li><p>This means that the project directory will also be set as working
directory. The exception is in a R Notebook, where the working directory
is where the R Notebook is saved.</p></li>
<li><p>You should be saving your notebooks in the R Project and using
<code>../..</code> to point at the main project directory.</p></li>
<li><p>Before starting, it may be helpful to have a chunk of code that
does the following:</p>
<ul>
<li>clear your workspace <code>rm(list=ls())</code></li>
<li>load your packages <code>library(&lt;package-name&gt;)</code></li>
<li>check your session information <code>sessionInfo()</code></li>
<li>list files in your working directory
<code>list.files(getwd())</code></li>
</ul></li>
</ul>
</div>
<div id="read-in-datasets" class="slide section level2">
<h1>Read in datasets</h1>
<p>Our first dataset will be a summary of results from Lab #6: A
comparisons of awk and perl.</p>
<p>You will need to add path information to the <code>raw_data</code>
directory once you have uncompressed the data tarball.</p>
<p>Read “Lab6_Perl_v_Awk.csv” into an object called
<code>pva</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pva=read.csv(file=&quot;Lab6_Perl_v_Awk.csv&quot;)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#View(pva)</span></span></code></pre></div>
<p>Read “BodyFat.csv” into an object called <code>fat</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fat=read.csv(file=&quot;BodyFat.csv&quot;)</span></span></code></pre></div>
</div>
<div class="slide section level2">

<p>You may also read in the previously made object:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pva <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;data/Perl_v_Awk.rds&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pva, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##   ID     Start.time Completion.time Operating.System...i.e..iOS..Ubuntu. Programming.Language. Sys.Run.Time.
## 1  2 10/19/20 16:05  10/19/20 16:29                                  IOS                   Awk            na
## 2  3 10/19/20 17:56  10/19/20 17:58                               Mac OS                  Perl         0.031
## 3  4 10/19/20 17:58  10/19/20 17:58                               Mac OS                   Awk          0.03
##   Input.VCF.File.Size.
## 1                 Full
## 2                 Full
## 3                 Full</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fat <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;data/BodyFat.rds&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fat, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##   IDNO BODYFAT DENSITY AGE WEIGHT HEIGHT ADIPOSITY NECK CHEST ABDOMEN  HIP THIGH KNEE ANKLE BICEPS FOREARM
## 1    1    12.6  1.0708  23 154.25  67.75      23.7 36.2  93.1    85.2 94.5  59.0 37.3  21.9   32.0    27.4
## 2    2     6.9  1.0853  22 173.25  72.25      23.4 38.5  93.6    83.0 98.7  58.7 37.3  23.4   30.5    28.9
## 3    3    24.6  1.0414  22 154.00  66.25      24.7 34.0  95.8    87.9 99.2  59.6 38.9  24.0   28.8    25.2
##   WRIST  X
## 1  17.1 NA
## 2  18.2 NA
## 3  16.6 NA</code></pre>
</div>
<div class="slide section level2">

<p>Click the data object in the environment tab in RStudio…</p>
<p>Notice these five columns of data:</p>
<ul>
<li><code>ID</code> (Student)</li>
<li><code>Sys.Run.Time.</code> (Run Time)</li>
<li><code>Programming.Language.</code> (e.g. Perl; Awk)</li>
<li><code>Input.VCF.File.Size</code> (Partial/Full File)</li>
<li><code>Operating.System...i.e..iOS..Ubuntu.</code> (OS)</li>
</ul>
<p>We also have some missing data.</p>
</div>
<div id="compare-runtime-of-perl-versus-awk"
class="slide section level2">
<h1>Compare runtime of Perl versus Awk</h1>
<p>Let’s compare the distribution of run times for each language.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(pva$Programming.Language.,pva$Sys.Run.Time.)</span></span></code></pre></div>
<p>Notice, the plot looks unexpected or it did not plot at all. That is
because we have some missing data and columns that have not been coded
correctly.</p>
<p>If you are reading in the raw data, we can read the data in again -
specifying that the string “na” should be coded as missing data and
columns with strings should be treated as factors (this means that these
columns can be summarized into categories or levels).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pva=read.csv(file=&quot;Lab6_Perl_v_Awk.csv&quot;,na.strings=&quot;na&quot;,stringsAsFactors = T)</span></span></code></pre></div>
</div>
<div class="slide section level2">

<h3 id="extra-dplyr-practice">Extra <code>dplyr</code> Practice</h3>
<p>If you are reading in the saved data object in the beginning, let’s
get some extra practice with <code>dplyr</code> (introduced in Module 3)
to perform these same modifications, step-by-step.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>pva <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">na_if</span>(pva, <span class="st">&quot;na&quot;</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pva, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##   ID     Start.time Completion.time Operating.System...i.e..iOS..Ubuntu. Programming.Language. Sys.Run.Time.
## 1  2 10/19/20 16:05  10/19/20 16:29                                  IOS                   Awk          &lt;NA&gt;
## 2  3 10/19/20 17:56  10/19/20 17:58                               Mac OS                  Perl         0.031
## 3  4 10/19/20 17:58  10/19/20 17:58                               Mac OS                   Awk          0.03
##   Input.VCF.File.Size.
## 1                 Full
## 2                 Full
## 3                 Full</code></pre>
<p>Notice the “na” strings are now properly coded as NAs (compare with
slide 5). If you run summary on the object, we still have the issue of
<code>Sys.Run.Time.</code> being coded as “character” data.</p>
<p>Let’s see how we can fix that on the next slide…</p>
</div>
<div class="slide section level2">

<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>pva<span class="sc">$</span>Sys.Run.Time. <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(pva<span class="sc">$</span>Sys.Run.Time.)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pva)</span></code></pre></div>
<pre><code>##        ID      Start.time        Completion.time    Operating.System...i.e..iOS..Ubuntu. Programming.Language.
##  Min.   : 2   Length:37          Length:37          Length:37                            Length:37            
##  1st Qu.:11   Class :character   Class :character   Class :character                     Class :character     
##  Median :20   Mode  :character   Mode  :character   Mode  :character                     Mode  :character     
##  Mean   :20                                                                                                   
##  3rd Qu.:29                                                                                                   
##  Max.   :38                                                                                                   
##                                                                                                               
##  Sys.Run.Time.      Input.VCF.File.Size.
##  Min.   :  0.0000   Length:37           
##  1st Qu.:  0.0160   Class :character    
##  Median :  0.0490   Mode  :character    
##  Mean   : 14.0506                       
##  3rd Qu.:  0.1205                       
##  Max.   :426.0000                       
##  NA&#39;s   :6</code></pre>
</div>
<div class="slide section level2">

<p>Fixed! Lastly, we want to make sure the other columns are treated as
categorical.</p>
<p>Here, we are specifying two columns to be treated as categorical
(i.e., mutate the data across <code>Programming.Language.</code> &amp;
<code>Input.VCF.File.Size.</code> by coding them factors).</p>
<p>Remember the <code>%&gt;%</code> symbol from magrittr (tidyverse) is
a <a
href="https://towardsdatascience.com/an-introduction-to-the-pipe-in-r-823090760d64">pipe</a>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>pva <span class="ot">&lt;-</span> pva <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(Programming.Language., Input.VCF.File.Size.), as.factor))</span></code></pre></div>
<p>Use <code>summary</code> to see the changes made to the two columns
of data we converted to factors.</p>
<p>We could convert all “character” columns to factors by replacing</p>
<p><code>...across(c(&lt;columns&gt;, &lt;targeted&gt;),...</code></p>
<p>with</p>
<p><code>...across(where(is.character),...</code></p>
</div>
<div class="slide section level2">

<p>Let’s try the plot again:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>pva<span class="sc">$</span>Programming.Language. <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(pva<span class="sc">$</span>Programming.Language.)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pva<span class="sc">$</span>Programming.Language.,pva<span class="sc">$</span>Sys.Run.Time.)</span></code></pre></div>
<p><img src="4.04.Advanced_Statistical_Concepts_in_R_files/figure-slidy/unnamed-chunk-6-1.png" width="768" /></p>
<p>Now, we have a box plot of each dataset.</p>
<p>What modification could you make to better visualize this plot?</p>
</div>
<div id="basic-summary-statistics" class="slide section level2">
<h1>Basic Summary Statistics</h1>
<p>Let’s revisit some basic summary statistics for this dataset.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pva)</span></code></pre></div>
<pre><code>##        ID      Start.time        Completion.time    Operating.System...i.e..iOS..Ubuntu. Programming.Language.
##  Min.   : 2   Length:37          Length:37          Length:37                            Awk   :13            
##  1st Qu.:11   Class :character   Class :character   Class :character                     Perl  :18            
##  Median :20   Mode  :character   Mode  :character   Mode  :character                     Python: 6            
##  Mean   :20                                                                                                   
##  3rd Qu.:29                                                                                                   
##  Max.   :38                                                                                                   
##                                                                                                               
##  Sys.Run.Time.      Input.VCF.File.Size.
##  Min.   :  0.0000   Full   :22          
##  1st Qu.:  0.0160   Partial:15          
##  Median :  0.0490                       
##  Mean   : 14.0506                       
##  3rd Qu.:  0.1205                       
##  Max.   :426.0000                       
##  NA&#39;s   :6</code></pre>
<p>Notice the range for mean run time is quite skewed. Let’s look at the
overall distribution</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pva<span class="sc">$</span>Sys.Run.Time.)</span></code></pre></div>
<p><img src="4.04.Advanced_Statistical_Concepts_in_R_files/figure-slidy/hist-1.png" width="768" /></p>
</div>
<div id="remove-outliers" class="slide section level2">
<h1>Remove outliers</h1>
<p>Because the majority of our observations are less than 1 and some
folks may have put actual run time instead of SysRunTime, let’s go ahead
and exclude these extreme values and look at the boxplot again:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>pva2<span class="ot">=</span><span class="fu">subset</span>(pva,pva<span class="sc">$</span>Sys.Run.Time.<span class="sc">&lt;=</span><span class="dv">1</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pva2<span class="sc">$</span>Programming.Language.,pva2<span class="sc">$</span>Sys.Run.Time.,<span class="at">main=</span><span class="st">&quot;Perl versus Awk&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Programming Language&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Sys Time in Seconds&quot;</span>)</span></code></pre></div>
<p><img src="4.04.Advanced_Statistical_Concepts_in_R_files/figure-slidy/remove%20outliers-1.png" width="768" /></p>
<p>Now we can see the boxes a bit better and while we still have
outliers, we’ve mostly removed the extremes.</p>
</div>
<div id="examine-mean-in-each-group" class="slide section level2">
<h1>Examine mean in each group</h1>
<p>From the boxplots, it looks like Awk is a bit slower than Perl, but
let’s compare the means of each group:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pva2<span class="sc">$</span>Sys.Run.Time.[pva2<span class="sc">$</span>Programming.Language.<span class="sc">==</span><span class="st">&quot;Perl&quot;</span>])</span></code></pre></div>
<pre><code>## [1] 0.04375</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pva2<span class="sc">$</span>Sys.Run.Time.[pva2<span class="sc">$</span>Programming.Language.<span class="sc">==</span><span class="st">&quot;Awk&quot;</span>])</span></code></pre></div>
<pre><code>## [1] 0.06309091</code></pre>
<p>Notice this new way of subsetting from categorical data.</p>
</div>
<div
id="but-didnt-we-do-large-and-small-file-sizes-we-should-look-at-this-a-bit-closer."
class="slide section level2">
<h1>But didn’t we do large and small file sizes? We should look at this
a bit closer.</h1>
<p>First, let’s look at the full size file results:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>full<span class="ot">=</span><span class="fu">subset</span>(pva2,pva2<span class="sc">$</span>Input.VCF.File.Size.<span class="sc">==</span><span class="st">&quot;Full&quot;</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(full<span class="sc">$</span>Programming.Language.,full<span class="sc">$</span>Sys.Run.Time.,<span class="at">main=</span><span class="st">&quot;Perl versus Awk for Full File&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Programming Language&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Sys Time in Seconds&quot;</span>)</span></code></pre></div>
<p><img src="4.04.Advanced_Statistical_Concepts_in_R_files/figure-slidy/full%20size-1.png" width="768" /></p>
<p>Here, Perl appears faster than Awk, with Python the slowest. But what
about for the smaller file when you used <code>head</code> to get only
the first 10,000 lines?</p>
</div>
<div id="smaller-file-size-comparison" class="slide section level2">
<h1>Smaller file size comparison</h1>
<p>Now, let’s look at the small size fill results:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>small<span class="ot">=</span><span class="fu">subset</span>(pva2,pva2<span class="sc">$</span>Input.VCF.File.Size.<span class="sc">==</span><span class="st">&quot;Partial&quot;</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(small<span class="sc">$</span>Programming.Language.,small<span class="sc">$</span>Sys.Run.Time.,<span class="at">main=</span><span class="st">&quot;Perl versus Awk for Small File&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Programming Language&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Sys Time in Seconds&quot;</span>)</span></code></pre></div>
<p><img src="4.04.Advanced_Statistical_Concepts_in_R_files/figure-slidy/small%20size-1.png" width="768" /></p>
<p>Now, Perl and Awk are pretty similar to each other and python is
still the slowest.</p>
</div>
<div id="again-lets-look-at-the-mean-values"
class="slide section level2">
<h1>Again, let’s look at the mean values:</h1>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#full file size</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(full<span class="sc">$</span>Sys.Run.Time.[full<span class="sc">$</span>Programming.Language.<span class="sc">==</span><span class="st">&quot;Perl&quot;</span>])</span></code></pre></div>
<pre><code>## [1] 0.06314286</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(full<span class="sc">$</span>Sys.Run.Time.[full<span class="sc">$</span>Programming.Language.<span class="sc">==</span><span class="st">&quot;Awk&quot;</span>])</span></code></pre></div>
<pre><code>## [1] 0.0995</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#short file size</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(small<span class="sc">$</span>Sys.Run.Time.[small<span class="sc">$</span>Programming.Language.<span class="sc">==</span><span class="st">&quot;Perl&quot;</span>])</span></code></pre></div>
<pre><code>## [1] 0.0166</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(small<span class="sc">$</span>Sys.Run.Time.[small<span class="sc">$</span>Programming.Language.<span class="sc">==</span><span class="st">&quot;Awk&quot;</span>])</span></code></pre></div>
<pre><code>## [1] 0.0194</code></pre>
<p>So, the means are different, but are they statistically
different?</p>
</div>
<div id="is-this-a-statistical-difference" class="slide section level2">
<h1>Is this a statistical difference?</h1>
<p>We can test this by using the function <code>aov</code> which fits
the data to an analysis of variance model. This calls the
<code>lm</code> function, which is for linear models.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>model_full<span class="ot">=</span><span class="fu">aov</span>(full<span class="sc">$</span>Sys.Run.Time.<span class="sc">~</span>full<span class="sc">$</span>Programming.Language.)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>model_small<span class="ot">=</span><span class="fu">aov</span>(small<span class="sc">$</span>Sys.Run.Time.<span class="sc">~</span>small<span class="sc">$</span>Programming.Language.)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">#get AOV Table</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_full)</span></code></pre></div>
<pre><code>##                            Df  Sum Sq  Mean Sq F value Pr(&gt;F)
## full$Programming.Language.  2 0.01012 0.005058   0.815  0.466
## Residuals                  12 0.07444 0.006204</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_small)</span></code></pre></div>
<pre><code>##                             Df    Sum Sq   Mean Sq F value Pr(&gt;F)
## small$Programming.Language.  2 0.0006213 0.0003106   0.955   0.42
## Residuals                    9 0.0029264 0.0003252</code></pre>
<p>Answer: NO! So, don’t do anything rash, like choose a particular
language based on these data!</p>
<p><em>On your own</em>: We also recorded OS in this dataset. On your
own, compare the sys run time based on OS just like we did here using
Programming Language. If you chose to read in the pre-existing object,
remember to revisit the code we used to correctly code our categorical
columns.</p>
</div>
<div id="now-lets-return-to-the-bodyfat.csv-dataset"
class="slide section level2">
<h1>Now, let’s return to the “BodyFat.csv” dataset</h1>
<p>Basic Summary Statistics:</p>
<p>As we did before, let’s revisit some basic summaries of this
dataset.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#statistical summary of data </span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fat)</span></code></pre></div>
<pre><code>##       IDNO           BODYFAT         DENSITY           AGE            WEIGHT          HEIGHT     
##  Min.   :  1.00   Min.   : 0.00   Min.   :0.995   Min.   :22.00   Min.   :118.5   Min.   :29.50  
##  1st Qu.: 63.75   1st Qu.:12.80   1st Qu.:1.041   1st Qu.:35.75   1st Qu.:159.0   1st Qu.:68.25  
##  Median :126.50   Median :19.00   Median :1.055   Median :43.00   Median :176.5   Median :70.00  
##  Mean   :126.50   Mean   :18.94   Mean   :1.056   Mean   :44.88   Mean   :178.9   Mean   :70.15  
##  3rd Qu.:189.25   3rd Qu.:24.60   3rd Qu.:1.070   3rd Qu.:54.00   3rd Qu.:197.0   3rd Qu.:72.25  
##  Max.   :252.00   Max.   :45.10   Max.   :1.109   Max.   :81.00   Max.   :363.1   Max.   :77.75  
##    ADIPOSITY          NECK           CHEST           ABDOMEN            HIP            THIGH      
##  Min.   :18.10   Min.   :31.10   Min.   : 79.30   Min.   : 69.40   Min.   : 85.0   Min.   :47.20  
##  1st Qu.:23.10   1st Qu.:36.40   1st Qu.: 94.35   1st Qu.: 84.58   1st Qu.: 95.5   1st Qu.:56.00  
##  Median :25.05   Median :38.00   Median : 99.65   Median : 90.95   Median : 99.3   Median :59.00  
##  Mean   :25.44   Mean   :37.99   Mean   :100.82   Mean   : 92.56   Mean   : 99.9   Mean   :59.41  
##  3rd Qu.:27.32   3rd Qu.:39.42   3rd Qu.:105.38   3rd Qu.: 99.33   3rd Qu.:103.5   3rd Qu.:62.35  
##  Max.   :48.90   Max.   :51.20   Max.   :136.20   Max.   :148.10   Max.   :147.7   Max.   :87.30  
##       KNEE           ANKLE          BICEPS         FOREARM          WRIST          X          
##  Min.   :33.00   Min.   :19.1   Min.   :24.80   Min.   :21.00   Min.   :15.80   Mode:logical  
##  1st Qu.:36.98   1st Qu.:22.0   1st Qu.:30.20   1st Qu.:27.30   1st Qu.:17.60   NA&#39;s:252      
##  Median :38.50   Median :22.8   Median :32.05   Median :28.70   Median :18.30                 
##  Mean   :38.59   Mean   :23.1   Mean   :32.27   Mean   :28.66   Mean   :18.23                 
##  3rd Qu.:39.92   3rd Qu.:24.0   3rd Qu.:34.33   3rd Qu.:30.00   3rd Qu.:18.80                 
##  Max.   :49.10   Max.   :33.9   Max.   :45.00   Max.   :34.90   Max.   :21.40</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(fat<span class="sc">$</span>WEIGHT)</span></code></pre></div>
<pre><code>## [1] 118.50 363.15</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(fat<span class="sc">$</span>BODYFAT)</span></code></pre></div>
<pre><code>## [1]  0.0 45.1</code></pre>
<p>Summary is a much more comprehensive view of this dataset.</p>
</div>
<div id="analyzing-a-complex-dataset" class="slide section level2">
<h1>Analyzing a complex dataset</h1>
<p>In a previous video, you were asked to analyze this dataset on your
own. Each of you did independent correlations of each variable and how
it correlated with bodyfat. Because these were non-independent tests, we
have to correct for multiple testing. However, a better way to compare
how different parameters predict a response variable is to fit the data
to a more complex model</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#first, like aov, we will fit a generalized linear model:</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">=</span><span class="fu">glm</span>(BODYFAT<span class="sc">~</span>WEIGHT<span class="sc">+</span>DENSITY<span class="sc">+</span>ADIPOSITY<span class="sc">+</span>AGE<span class="sc">+</span>HEIGHT<span class="sc">+</span>NECK<span class="sc">+</span>CHEST<span class="sc">+</span>ABDOMEN<span class="sc">+</span>HIP<span class="sc">+</span>THIGH<span class="sc">+</span>KNEE<span class="sc">+</span>ANKLE<span class="sc">+</span>BICEPS<span class="sc">+</span>FOREARM<span class="sc">+</span>WRIST,<span class="at">data=</span>fat)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co">#to see the fit, we will make a summary table</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = BODYFAT ~ WEIGHT + DENSITY + ADIPOSITY + AGE + 
##     HEIGHT + NECK + CHEST + ABDOMEN + HIP + THIGH + KNEE + ANKLE + 
##     BICEPS + FOREARM + WRIST, data = fat)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -7.7632  -0.3308  -0.0954   0.2078  13.9487  
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  4.190e+02  9.802e+00  42.750   &lt;2e-16 ***
## WEIGHT       1.197e-02  1.467e-02   0.816    0.415    
## DENSITY     -3.816e+02  7.559e+00 -50.481   &lt;2e-16 ***
## ADIPOSITY   -5.493e-02  8.113e-02  -0.677    0.499    
## AGE          1.078e-02  8.808e-03   1.224    0.222    
## HEIGHT      -1.782e-02  3.019e-02  -0.590    0.556    
## NECK        -2.062e-02  6.427e-02  -0.321    0.749    
## CHEST        2.993e-02  2.856e-02   1.048    0.296    
## ABDOMEN      2.260e-02  3.016e-02   0.749    0.454    
## HIP          1.611e-02  4.023e-02   0.401    0.689    
## THIGH        1.354e-03  3.980e-02   0.034    0.973    
## KNEE        -3.978e-02  6.705e-02  -0.593    0.554    
## ANKLE       -7.170e-02  6.073e-02  -1.181    0.239    
## BICEPS      -6.291e-02  4.688e-02  -1.342    0.181    
## FOREARM      4.324e-02  5.447e-02   0.794    0.428    
## WRIST        3.640e-02  1.480e-01   0.246    0.806    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for gaussian family taken to be 1.359181)
## 
##     Null deviance: 15079.02  on 251  degrees of freedom
## Residual deviance:   320.77  on 236  degrees of freedom
## AIC: 809.95
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<p>Here, we have built a statistical model to show how body fat varies
due to MULTIPLE parameters in the data.</p>
</div>

  <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
      document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>

</body>
</html>
